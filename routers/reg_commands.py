from aiogram import Router, F
from aiogram.types import Message
from aiogram.filters.command import Command

# –ò–º–ø–æ—Ä—Ç –±–¥
from database import (
    get_user_profile
)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–∞–º–æ–π –∞–Ω–∫–µ—Ç—ã, –±–µ—Ä–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ë–î(–±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è —á–∞—Å—Ç–∏—á–Ω–æ)
async def get_profile_text(user_id: int) -> str:
    """
    –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∫–µ—Ç—ã.
    –≠—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º —Ä–æ—É—Ç–µ—Ä–µ.
    """
    profile_data = get_user_profile(user_id)
    
    if profile_data:
        # –ï—Å–ª–∏ –≤ –ø–æ–ª–µ –æ–ø–∏—Å–∞–Ω–∏—è –Ω–∏—á–µ–≥–æ –Ω–µ—Ç (None), –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
        description = profile_data.get("description") or "–ù–µ —É–∫–∞–∑–∞–Ω–æ"

        # –°–æ–±–∏—Ä–∞–µ–º –∫—Ä–∞—Å–∏–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        text = (
            f"üë§ **–î–æ—Å—å–µ –≥—Ä–∞–∂–¥–∞–Ω–∏–Ω–∞**\n\n"
            f"üóÉÔ∏è **–£—á—ë—Ç–Ω–æ–µ –∏–º—è:** `{profile_data['nickname']}`\n"
            f"üÜî **–ü—É–±–ª–∏—á–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä:** `{user_id}`\n\n"
            f"üçö **–°–æ—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥:** {profile_data['reputation']}\n"
            f"‚òÄÔ∏è **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** {profile_data['activity']}\n\n"
            f"üìÑ **–û–ø–∏—Å–∞–Ω–∏–µ:**\n_{description}_"
        )
        return text
    else:
        return "–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ç–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å. –ü–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å /start"